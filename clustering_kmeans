import numpy as np
from sklearn import cluster
import rasterio
import matplotlib.pyplot as plt

# Read in raster image 
with rasterio.open('data/ndvi/2021_ndvi.tif') as src:
    img = src.read(1)  # Assuming you want to read the first band
    print(img.shape)

X = img.flatten().reshape((-1, 1))
print(X.shape)

k_means = cluster.KMeans(n_clusters=16)
k_means.fit(X)

X_cluster = k_means.labels_
X_cluster = X_cluster.reshape(img.shape)

print(len(X_cluster))

# matplotlib inline  

plt.figure(figsize=(20, 20))
plt.imshow(X_cluster, cmap="hsv")
plt.show()
